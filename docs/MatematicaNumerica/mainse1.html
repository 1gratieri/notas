<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xml:lang="pt" xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Problemas lineares</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- 3,notoc*,charset=utf-8,html,xhtml --> 
<meta name="src" content="main.tex" /> 
<meta name="date" content="2018-05-25 09:01:00" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<link rel="stylesheet" type="text/css" href="main.css" /> 
<script type="text/javascript" 
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS_CHTML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
<meta name="generator" content="Pedro H A Konzen"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body 
>
   <!--l. 6--><div class="crosslinks"><p class="noindent">[<a 
href="#tailmainse1.html">tail</a>] [<a 
href="mainch2.html#mainse1.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x6-50002.1"></a>Problemas lineares</h3>
<!--l. 8--><p class="noindent" >Dado um conjunto de $n$ pontos $\{(x_i,y_i)\}_{i=1}^n$, $x_i\neq x_j$ para $i\neq j$, e uma família de $m \leq n$ funções $\{f_i(x)\}_{i=1}^m$, o problema
linear de aproximação por mínimos quadrados consiste em determinar os $m$
coeﬁcientes $\{c_i\}_{i=1}^m$ tal que a função
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-5001r1"></a>
   <center class="math-display" >
<img 
src="main0x.png" alt="        m&sum;
f (x ) =    cifi(x) = c1f1(x) + c2f2(x) + c3f3(x) + &sdot;&sdot;&sdot; + cnfn (x)
        i=1
" class="math-display"  /></center></td><td class="equation-label">(2.1)</td></tr></table>
<!--l. 11--><p class="nopar" >
aproxime o conjunto de pontos dados no sentido de mínimos quadrados, i.e. os
coeﬁcientes que são solução do seguinte problema linear de minimização
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-5002r2"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main1x.png" alt="           n
          &sum;             2
{c1m,ci2n,...,cn}  (yi &minus; fi(xi)) .
          i=1
" class="math-display"  /></center></td><td class="equation-label">(2.2)</td></tr></table>
<!--l. 15--><p class="nopar" >
</p><!--l. 17--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x6-60002.1.1"></a>Equações normais</h4>
<!--l. 19--><p class="noindent" >Aﬁm de resolver o problema de mínimos quadrados (<a 
href="#x6-5002r2">2.2<!--tex4ht:ref: eq:pmq --></a>), observamos que o erro
quadrático
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6001r3"></a>
   <center class="math-display" >
<img 
src="main2x.png" alt="                           (               ) 2
     &sum;n                &sum;n        m&sum;
E :=    (yi &minus; fi(xi))2 =   (yi &minus;    cjfj(xi))
     i=1                i=1       j=1
" class="math-display"  /></center></td><td class="equation-label">(2.3)</td></tr></table>
<!--l. 22--><p class="nopar" >
tem seu mínimo para os coeﬁcientes $c_k$ tais que
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6002r4"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main3x.png" alt="&part;E
----=  0,  k = 1,2,3,...,m.
&part;ck
" class="math-display"  /></center></td><td class="equation-label">(2.4)</td></tr></table>
<!--l. 26--><p class="nopar" >
Calculando estas derivadas parciais, temos
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6003r5"></a>
   <center class="math-display" >
<img 
src="main4x.png" alt="            n (      m         )2
&part;E--=  -&part;--&sum;  (y  &minus; &sum;  c f (x ))
&part;ck    &part;ck i=1    i  j=1 j j  i
           (                )
        &sum;n        m&sum;
    =  2   (yi &minus;     cjfj(xi)) f (xk )
        i=1       j=1
        &sum;n             &sum;n &sum;m
    =  2   yif(xk ) &minus; 2      cjfj(xi)f(xk),  k = 1,2,3,...,m.
        i=1            i=1 k=1
" class="math-display"  /></center></td><td class="equation-label">(2.5)</td></tr></table>
<!--l. 34--><p class="nopar" >
</p><!--l. 36--><p class="indent" >   Desta forma, a equação (<a 
href="#x6-6002r4">2.4<!--tex4ht:ref: eq:aux1_mq --></a>) é equivalente a resolver o seguinte sistema
linear
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6004r6"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main5x.png" alt="&sum;n &sum;m                 &sum;n
      cjfj(xi)f(xk) =    yif(xk),  k = 1,2, 3,...,m.
i=1 k=1                i=1
" class="math-display"  /></center></td><td class="equation-label">(2.6)</td></tr></table>
<!--l. 39--><p class="nopar" >
</p><!--l. 41--><p class="indent" >   Agora, denotando
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6005r7"></a>
   <center class="math-display" >
<img 
src="main6x.png" alt="      &lfloor;                           &rfloor;
      |f1(x1)  f2(x1)  &sdot;&sdot;&sdot;  fm(x1)|
      ||                           ||
      ||f1(x2)  f2(x2)  &sdot;&sdot;&sdot;  fm(x2)||
A :=  ||   ..       ..     ..      ..  ||
      |&lceil;   .       .     .      .  |&rceil;
       f (x )  f (x )  &sdot;&sdot;&sdot;  f (x )
        1  n    2  n         m  n
" class="math-display"  /></center></td><td class="equation-label">(2.7)</td></tr></table>
<!--l. 50--><p class="nopar" >
o sistema linear (<a 
href="#x6-6004r6">2.6<!--tex4ht:ref: eq:aux2_mq --></a>) pode ser escrito na seguinte forma matricial
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6006r8"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main7x.png" alt="  T       T
A  Ac =  A  y,
" class="math-display"  /></center></td><td class="equation-label">(2.8)</td></tr></table>
<!--l. 54--><p class="nopar" >
onde $c = (c_1, c_2, \dotsc , c_m)$ é o vetor dos coeﬁcientes e $y = (y_1, y_2, \dotsc , y_n)$ é o vetor das abscissas dos pontos
dados.
</p>
   <div class="newtheorem">
<!--l. 57--><p class="noindent" ><span class="head">
<a 
 id="x6-6007r1"></a>
<span 
class="ec-lmbx-12">Exemplo 2.1.1.</span>  </span>(Ajuste de polinômios) Considere o problema de ajustar o
conjunto de pontos </p>
<div class="center" 
>
<!--l. 59--><p class="noindent" >
</p>
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /><col 
id="TBL-2-3" /><col 
id="TBL-2-4" /><col 
id="TBL-2-5" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11">      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11"> hline  $i$</td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-2-2"  
class="td11"> $1$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-2-3"  
class="td11"> $2$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-2-4"  
class="td11"> $3$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-2-5"  
class="td11"> $4$ </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11"> $x_i$      </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-2"  
class="td11"> $-1$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-3"  
class="td11"> $0$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-4"  
class="td11"> $1$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-3-5"  
class="td11"> $1,5$ </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11"> $y_i$      </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-4-2"  
class="td11"> $1,2$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-4-3"  
class="td11"> $-0,1$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-4-4"  
class="td11"> $0,7$ </td><td  style="white-space:nowrap; text-align:right;" id="TBL-2-4-5"  
class="td11"> $2,4$ </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11">       </td></tr></table></div></div>
<!--l. 66--><p class="noindent" >por um polinômio quadrático da forma
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6008r9"></a>
   <center class="math-display" >
<img 
src="main8x.png" alt="          2
p(x) = p1x  + p2x + pn
" class="math-display"  /></center></td><td class="equation-label">(2.9)</td></tr></table>
<!--l. 69--><p class="nopar" >
no sentido de mínimos quadrados.
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x6-60091"></a>
<img 
src="main9x.png" alt="PIC" class="graphics" width="390.0pt" height="293.1734pt"  /><!--tex4ht:graphics  
name="main9x.png" src="cap_ajuste/figs/ex_mq_curvas/ex_mq_curvas.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figura 2.1: </span><span  
class="content">Esboço da curva ajustada no Exemplo <a 
href="#x6-6014r2">2.1.2<!--tex4ht:ref: ex:ajuste_de_curvas --></a>.</span></div><!--tex4ht:label?: x6-60091 -->
   </div><hr class="endfigure" />
<!--l. 80--><p class="indent" >   Neste caso, a família de funções do problema de mínimos quadrados é $f_1(x) = x^2$, $f_2(x) = x$ e $f_3(x) = 1$.
Assim sendo, os coeﬁcientes $p = (p_1, p_2, p_3)$ são solução do seguinte sistema linear
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6010r10"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main10x.png" alt="AT Ap =  AT y,
" class="math-display"  /></center></td><td class="equation-label">(2.10)</td></tr></table>
<!--l. 83--><p class="nopar" >
onde $y = (y_1, y_2, y_3)$ e
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6011r11"></a>
   <center class="math-display" >
<img 
src="main11x.png" alt="     &lfloor;          &rfloor;
     | x21  x1  1|
     ||          ||
     || x22  x2  1||
     ||  2       ||
A := || x3  x3  1|| .
     ||  2       ||
     |&lceil; x4  x4  1|&rceil;
" class="math-display"  /></center></td><td class="equation-label">(2.11)</td></tr></table>
<!--l. 93--><p class="nopar" >
Emﬁm, resolvendo as equações normais (<a 
href="#x6-6010r10">2.10<!--tex4ht:ref: eq:aux3_md --></a>), obtemos
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6012r12"></a>
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main12x.png" alt="            2
p(x) = 1,25x  &minus;  0,188x &minus;  0,203.
" class="math-display"  /></center></td><td class="equation-label">(2.12)</td></tr></table>
<!--l. 97--><p class="nopar" >
A Figura <a 
href="#x6-60132">2.2<!--tex4ht:ref: fig:ex_mq_poli --></a> mostra um esboço dos pontos (em vermelho) e do polinômio
ajustado (em azul).
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x6-60132"></a>
<img 
src="main13x.png" alt="PIC" class="graphics" width="390.0pt" height="293.1734pt"  /><!--tex4ht:graphics  
name="main13x.png" src="cap_ajuste/figs/ex_mq_poli/ex_mq_poli.eps"  
-->
<br /> <div class="caption" 
><span class="id">Figura 2.2: </span><span  
class="content">Esboço do polinômio ajustado no Exemplo <a 
href="#x6-6007r1">2.1.1<!--tex4ht:ref: ex:ajuste_de_polinomios --></a>.</span></div><!--tex4ht:label?: x6-60132 -->
   </div><hr class="endfigure" />
                                                                          

                                                                          
<!--l. 108--><p class="indent" >   Os coeﬁcientes e um esboço do polinômio ajustado podem ser obtidos no
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">GNU</span><span 
class="ec-lmtt-12"> Octave</span></span></span> com o seguinte código:
                                                                          

                                                                          
</p>
   <div class="verbatim" id="verbatim-1">
#pontos
 <br />x = [-1 0 1 1.5]&#x2019;;
 <br />y = [1.2, -0.1, 0.7, 2.4]&#x2019;;
 <br />
 <br />#resol. as eqs. normais
 <br />A = [x.^2 x.^1 x.^0];
 <br />p = inv(A&#x2019;*A)*A&#x2019;*y
 <br />
 <br />#esboco do pol. ajustado
 <br />xx = linspace(-1.25,1.75);
 <br />plot(x,y,&#x2019;ro&#x2019;,...
 <br />     xx,polyval(p,xx));grid
</div>
<!--l. 122--><p class="nopar" >
</p>
   </div>
   <div class="newtheorem">
<!--l. 128--><p class="noindent" ><span class="head">
<a 
 id="x6-6014r2"></a>
<span 
class="ec-lmbx-12">Exemplo 2.1.2.</span>  </span>(Ajuste de curvas) Consideremos o mesmo conjunto de pontos
do exemplo anterior (Exemplo <a 
href="#x6-6007r1">2.1.1<!--tex4ht:ref: ex:ajuste_de_polinomios --></a>). Aqui, vamos ajustar uma curva da
forma
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6015r13"></a>
   <center class="math-display" >
<img 
src="main14x.png" alt="f(x ) = c1 sen(x) + c2cos(x) + c3
" class="math-display"  /></center></td><td class="equation-label">(2.13)</td></tr></table>
<!--l. 132--><p class="nopar" >
no sentido de mínimos quadrados. Para tanto, formamos a matrix
</p>
   <table 
class="equation"><tr><td><a 
 id="x6-6016r14"></a>
   <center class="math-display" >
<img 
src="main15x.png" alt="      &lfloor;                   &rfloor;

      ||sen (x1 ) cos(x1)  1||
      ||sen (x  ) cos(x )  1||
      ||      2        2   ||
A :=  ||sen (x3 ) cos(x3)  1||
      ||                   ||
      ||sen (x4 ) cos(x4)  1||
      &lceil;                   &rceil;
" class="math-display"  /></center></td><td class="equation-label">(2.14)</td></tr></table>
<!--l. 142--><p class="nopar" >
e, então, resolvemos as equações normais $A^TAc = A^Ty$ para o vetor de coeﬁcientes $c=(c_1, c_2)$. Fazendo
isso, obtemos $c_1=-0,198$, $c_2=-2,906$ e $c_3=2,662$. A Figura <span 
class="ec-lmbx-12">??</span> mostra um esboço da curva ajustada (linha azul)
aos pontos dados (círculos vermelhos).
</p><!--l. 146--><p class="indent" >   Os coeﬁcientes e um esboço do polinômio ajustado podem ser obtidos no
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">GNU</span><span 
class="ec-lmtt-12"> Octave</span></span></span> com o seguinte código:
                                                                          

                                                                          
</p>
   <div class="verbatim" id="verbatim-2">
#pontos
 <br />x = [-1 0 1 1.5]&#x2019;;
 <br />y = [1.2, -0.1, 0.7, 2.4]&#x2019;;
 <br />
 <br />#resol. as eqs. normais
 <br />A = [sin(x) cos(x) ones(4,1)];
 <br />c = inv(A&#x2019;*A)*A&#x2019;*y
 <br />
 <br />#curva ajustada
 <br />f = @(x) c(1)*sin(x) + c(2)*cos(x) + c(3)
 <br />
 <br />#esboco do pol. ajustado
 <br />xx = linspace(-1.25,1.75);
 <br />plot(x,y,&#x2019;ro&#x2019;,...
 <br />     xx,f(xx));grid
</div>
<!--l. 163--><p class="nopar" >
</p>
   </div>
                                                                          

                                                                          
                                                                          

                                                                          
   <!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="mainse1.html" >front</a>] [<a 
href="mainch2.html#mainse1.html" >up</a>] </p></div>
<!--l. 1--><p class="indent" >   <a 
 id="tailmainse1.html"></a>  </p> 
</body></html> 
